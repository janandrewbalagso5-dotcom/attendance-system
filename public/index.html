<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Attendance System</title>
  <link rel="stylesheet" href="style.css">

  <!-- Face API CDN -->
  <script defer src="https://unpkg.com/face-api.js@0.22.2/dist/face-api.min.js"></script>

  <!-- MODULE SCRIPTS -->
  <script type="module" src="supabase.js"></script>
  <script type="module" src="auth.js"></script>
  <script type="module" src="face.js"></script>
  <script type="module" src="fingerprint.js"></script>
</head>

<body>

    <!-- HEADER SECTION -->
  <div class="header">
    <h2>Attendance System
  <button id="logoutBtn">Logout</button>
  </h2>
  </div>

  <!-- AUTH SECTION -->
  <div id="authSection">
    <h3>Login / Signup</h3>
    <input type="email" id="email" placeholder="Email"><br><br>
    <input type="password" id="password" placeholder="Password"><br><br>

    <button id="loginBtn">Login</button>
    <button id="signupBtn">Sign Up</button>
  </div>

  <!-- APP SECTION -->
  <div id="appSection" style="display:none;">
    <hr>

  <!-- Registration Inputs -->
<h3>Register Face</h3>

<div class="form-group">
  <label for="studentId">Student ID:</label><br>
  <input id="studentId" placeholder="231-08-0007" /><br><br>
</div>

<div class="form-group">
  <label for="name">Full Name:</label><br>
  <input id="name" placeholder="Mark Zuckerberg" /><br><br>
</div>

<div class="form-group">
  <label for="major">Major:</label><br>
  <select id="major">
    <option value="" disabled selected>Select Major</option>
    <option value="BSIT">BSIT</option>
    <option value="BSA">BSA</option>
    <option value="BSBA">BSBA</option>
    <option value="BSCRIM">BSCRIM</option>
    <option value="COA">COA</option>
    <option value="BSHM">BSHM</option>
    <option value="BEED">BEED</option>
  </select><br><br>
</div>

<button id="registerBtn">Register Face</button>

<!-- Message / Profile -->
<div id="reg-message" class="info" style="margin-top:10px;"></div>


    <!-- PROFILE CARD -->
    <div class="card" id="profileCard" hidden>
      <img id="profilePhoto" class="profile-photo" />
      <h3 id="profileName"></h3>
      <p><b>ID:</b> <span id="profileStudentId"></span></p>
      <p><b>Major:</b> <span id="profileMajor"></span></p>

      <div class="actions">
        <button id="editProfileBtn"> Edit Profile</button>
      </div>
    </div>

    <div class="card">
      <h3>Registration Mode</h3>
      <button id="newStudentBtn"> New Student</button>
      <button id="existingStudentBtn"> Add Face to Existing</button>
    </div>

    <hr>

    <!-- Video for Face Capture -->
    <video id="video" width="400" autoplay muted style="border:1px solid #000;"></video>
    <br>
    <button id="attendanceBtn">Mark Attendance</button>
    
    <hr>

    <!-- Attendance Dashboard -->
    <h3>Attendance Dashboard</h3>
    <table border="1" cellspacing="0" cellpadding="5">
      <thead>
        <tr>
          <th>Name</th>
          <th>Time</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="dashboard-body"></tbody>
    </table>
  </div>

  <script>
    // Attach auth buttons after DOM loads
    document.addEventListener("DOMContentLoaded", () => {
      const loginBtn = document.getElementById("loginBtn");
      const signupBtn = document.getElementById("signupBtn");
      const logoutBtn = document.getElementById("logoutBtn");

      if (loginBtn) loginBtn.addEventListener("click", login);
      if (signupBtn) signupBtn.addEventListener("click", signUp);
      if (logoutBtn) logoutBtn.addEventListener("click", logout);
    });
  </script>
</body>
</html>
